
       <app-filter-form #newFilters ></app-filter-form>


   
   <mat-table id="orderTable" #table [dataSource]="orders" matSort class="mat-elevation-z8">

         <ng-container matColumnDef="id" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)="paginate('id')"  >Id</mat-header-cell>
           <mat-cell   *matCellDef="let order; row" >
             <a [routerLink]="[ '/order-detail', order.id ]"><mat-icon matTooltip="View Full Details">pageview</mat-icon></a>
             {{order.id}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="due_date" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("due_date")' >Due Date</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"  >
              {{order.due_date | date:'MM/dd/yyyy'}}
       <!--<app-time-difference (reached)="callback($event)" units="Mon| Days | Hours | Minutes"  end={{order.due_date}}></app-time-difference>-->
             </mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="buyer_name" >
           <mat-header-cell *matHeaderCellDef  mat-sort-header  (click)='paginate("buyer__name")' >Buyer</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   id="updates">{{order.buyer_name}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="factory_name" class="overflow">
           <mat-header-cell *matHeaderCellDef  mat-sort-header (click)='paginate("factory__name")' class="overflow">Factory</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"  >{{order.factory_name}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="order_type" >
             <mat-header-cell *matHeaderCellDef  mat-sort-header (click)='paginate("order_type")'  >Order Type</mat-header-cell>
             <mat-cell   *matCellDef="let order; row"  >{{order.order_type}}</mat-cell>
             <mat-footer-cell *matFooterCellDef >P&L</mat-footer-cell>
           </ng-container>


         <ng-container matColumnDef="buyer_style_number" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("buyer_style_number")' >Buyer Style #</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   >{{order.buyer_style_number}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="jp_style_number" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("jp_style_number")'>JP Style #</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   >{{order.jp_style_number}}</mat-cell>
           <mat-footer-cell *matFooterCellDef [ngClass]="{'aligne-right': true}"></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="factory_ship_date">
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("factory_ship_date")' >Factory Ship Date</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"    id="updates" >{{order.factory_ship_date | date:'MM/dd/yyyy' }}</mat-cell>
           <mat-footer-cell *matFooterCellDef><span  style="font-size:xx-small">JP Cost: {{totalCost.jpCost | currency}}</span></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="cost_from_factory">
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("cost_from_factory")'  >Cost From Factory</mat-header-cell>
           <mat-cell   *matCellDef="let order; row">{{order.cost_from_factory | currency}}</mat-cell>
           <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="buyers_price" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("buyers_price")' >Price Buyer Paid</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   >{{order.buyers_price | currency}}</mat-cell>
           <mat-footer-cell *matFooterCellDef><span style="font-size:xx-small">Customers Paid: {{totalCost.buyerCost | currency}}</span></mat-footer-cell>
         </ng-container>

          

         <ng-container matColumnDef="qty" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("qty")' >Quantity</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   >{{order.qty}}</mat-cell>
           <mat-footer-cell *matFooterCellDef style="font-size:xx-small" >P&L Before Expense: {{totalCost.simpleProfit | currency}}</mat-footer-cell>
         </ng-container>
         <ng-container matColumnDef="total_expense">
             <mat-header-cell *matHeaderCellDef >Exp. Cost</mat-header-cell>
             <mat-cell   *matCellDef="let order; row"  id="updates" >
                <span *ngFor="let expense of order.orderExpense" >{{expense.totalExpense | currency}}</span>
               </mat-cell>
             <mat-footer-cell *matFooterCellDef style="font-style: xx-small "></mat-footer-cell>
           </ng-container>
          
            

         <ng-container matColumnDef="sweater_image">
           <mat-header-cell *matHeaderCellDef >Image</mat-header-cell>
           <mat-cell   *matCellDef="let order; row">
              <img src='{{order.sweater_image}}' />

          </mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="brand" >
           <mat-header-cell *matHeaderCellDef mat-sort-header (click)='paginate("brand")' >Brand</mat-header-cell>
           <mat-cell   *matCellDef="let order; row"   >{{order.brand}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="sweater_description" class="overflow">
           <mat-header-cell *matHeaderCellDef >Description</mat-header-cell>
           <mat-cell  *matCellDef="let order; row" >{{order.sweater_description}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>


         <ng-container matColumnDef="fiber_content" class="overflow">
           <mat-header-cell *matHeaderCellDef >Fiber Content </mat-header-cell>
           <mat-cell *matCellDef="let order; row"   >{{order.fiber_content}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="color" >
           <mat-header-cell *matHeaderCellDef >Color</mat-header-cell>
           <mat-cell *matCellDef="let order; row"    >{{order.color}}</mat-cell>
           <mat-footer-cell *matFooterCellDef></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="update">
           <mat-header-cell *matHeaderCellDef >Update Order</mat-header-cell>
           <mat-cell  id="updates"  *matCellDef="let order; row" id="updates">
             <button mat-icon-button (click)="openUpdateDialog(order)"><mat-icon matTooltip="Update Order">update</mat-icon></button>
             <button mat-icon-button (click)="openDeleteDialog(order)"><mat-icon matTooltip="Delete Order">delete</mat-icon></button>

             </mat-cell>
           <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
         </ng-container>
         <ng-container matColumnDef="tasks">
           <mat-header-cell *matHeaderCellDef >Tasks</mat-header-cell>
           <mat-cell  id="updates"  *matCellDef="let order; row">
                   <button mat-icon-button (click)="openAddTask(order)"><mat-icon matTooltip="Add Tasks">add</mat-icon></button>
                   <button mat-icon-button (click)="openUpdateTask(order)" [disabled]="order.tasks.leng=== 0">
                       <span  matBadge={{order.completeTasks.length}}
                        matBadgeSize="small"  matBadgeColor="#CBE9CB" matBadgePosition="above before"></span>
                     <mat-icon matBadge={{order.incompleteTasks.length}}
                       matBadgeSize="small"  matBadgeColor="warn" matTooltip="Update Tasks" >
                        update
                     </mat-icon>
                   </button>
           </mat-cell>
           <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
         </ng-container>

         <ng-container matColumnDef="expenses">
             <mat-header-cell *matHeaderCellDef matTooltip="Expenses">Exp.</mat-header-cell>
             <mat-cell id="updates"    *matCellDef="let order; row"   >
                     <button mat-icon-button (click)="openAddExpenseDialog(order)">
                         <mat-icon matBadgeSize="small"  matBadgeColor="warn" matTooltip="Add Order Expense">
                            attach_money
                         </mat-icon>
                       </button>
             </mat-cell>
             <mat-footer-cell *matFooterCellDef></mat-footer-cell>
           </ng-container>



            
     <mat-header-row *matHeaderRowDef="displayColumns"></mat-header-row>
     <mat-row *matRowDef="
      let row;
      let even = even;
      columns: displayColumns;" 
     (click)="onRowClicked(row)"
     [ngClass]="{'highlight': selectedRowIndex == row.id, 'light-blue':even}" color="primary"></mat-row>
     <mat-footer-row *matFooterRowDef="displayColumns"></mat-footer-row>
        

   </mat-table>
   <mat-paginator class="marginless-paginator-range-label" #paginator
    [length]=length
    [pageSize]=pageSize
    [pageSizeOptions]='pageSizeOptions'
    showFirstLastButtons='false'
    (page)="paginate()"
    class="mat-elevation-z8"
    ></mat-paginator>



<!--
  <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="50px" style='padding-top: 20px'>
      

         <ng-container *ngIf='order && order.tasks.leng>0'>
             <span *ngFor="let tasks of order.tasks">
                 <app-order-cards [tasks]='tasks' [avatar]='order.sweater_image'></app-order-cards>
             </span>
         </ng-container>

   </div>-->